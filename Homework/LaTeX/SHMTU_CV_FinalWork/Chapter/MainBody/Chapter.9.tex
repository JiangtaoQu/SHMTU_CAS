\chapter{Microsoft Windows .Net 平台的部署及混合编译的探究}
\label{chapter:9dotnet}

\section{背景}

\section{解决方案}

\subsection{Microsoft ML Nuget包}

没有opencv

\subsection{通过CLR调用C++}

\section{工作流程}

\begin{enumerate}
	\item .Net WPF显示界面
	\item C\#下载图片或从本地加载图片
	\item C\#程序通过CLR Connector这个C\#的中间层与CLR进行连接
	\item CLR C++为C\#提供接口
	\item CAS\_OCR.cpp相关逻辑
\end{enumerate}

\section{CLR程序设计}

\subsection{CLR静态库}

我们无法将CLR的动态库编译为静态库，Visual C++编译器报错提示"/clr"与"/mt"两个参数不可以同时使用，而后者为编译动态库的参数，因此只能使用"/MDd"参数编译动态链接库。因此.Net C\#客户端并没有静态库版本。

\section{CLR Connector程序设计}

\section{运行截图}

\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{Resources/Picture/wpf_main}
	\caption{WPF 主界面}
	\label{fig:wpfmain}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{Resources/Picture/wpf_memory}
	\caption{WPF程序内存占用(加载模型后)}
	\label{fig:wpfmemory}
\end{figure}
